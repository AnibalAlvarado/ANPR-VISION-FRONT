<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <ng-container *ngFor="let field of config">

    <!-- Campos de texto / número / teléfono -->
    <mat-form-field *ngIf="field.type === 'text' || field.type === 'tel' || field.type === 'number'"
                    appearance="outline" style="width: 100%;">
      <mat-label>{{ field.label }}</mat-label>
      <input
        matInput
        [type]="field.type"
        [formControlName]="field.name"
        [required]="!!field.required">
      <mat-error *ngIf="form.get(field.name)?.hasError('required')">
        {{ field.label }} es obligatorio
      </mat-error>
    </mat-form-field>

    <!-- Textarea -->
    <mat-form-field *ngIf="field.type === 'textarea'" appearance="outline" style="width: 100%;">
      <mat-label>{{ field.label }}</mat-label>
      <textarea
        matInput
        [formControlName]="field.name"
        [required]="!!field.required"
        rows="4"></textarea>
      <mat-error *ngIf="form.get(field.name)?.hasError('required')">
        {{ field.label }} es obligatorio
      </mat-error>
    </mat-form-field>

    <!-- Select (soporta multiple) -->
    <mat-form-field *ngIf="field.type === 'select'" appearance="outline" style="width: 100%;">
      <mat-label>{{ field.label }}</mat-label>
      <mat-select
        [formControlName]="field.name"
        [required]="!!field.required"
        [multiple]="!!field.multiple"
        [compareWith]="compareByValue">
        <mat-option *ngFor="let opt of field.options" [value]="opt.value">
          {{ opt.label }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="form.get(field.name)?.hasError('required')">
        {{ field.label }} es obligatorio
      </mat-error>
    </mat-form-field>

    <!-- Toggle -->
    <mat-slide-toggle
      *ngIf="field.type === 'toggle'"
      [formControlName]="field.name"
      color="primary">
      {{ field.label }}
    </mat-slide-toggle>

  </ng-container>

  <div style="margin-top: 1rem;">
    <button mat-raised-button color="primary" type="submit">
      {{ isEdit ? 'Actualizar' : 'Crear' }}
    </button>
    <button mat-button type="button" (click)="cancelForm.emit()">Cancelar</button>
  </div>
</form>
